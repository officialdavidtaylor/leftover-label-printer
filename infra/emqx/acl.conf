%% Backend role permissions.
{allow, {username, "backend"}, publish, ["printers/+/jobs"]}.
{allow, {username, "backend"}, subscribe, ["printers/+/status"]}.

%% Agent role permissions; username maps to printerId.
{allow, {username, {re, "^printer-[A-Za-z0-9_-]+$"}}, subscribe, ["printers/${username}/jobs"]}.
{allow, {username, {re, "^printer-[A-Za-z0-9_-]+$"}}, publish, ["printers/${username}/status"]}.

{deny, all}.
